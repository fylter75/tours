<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <template id="custom_external_layout_header2">
            <t t-if="o and 'company_id' in o">
                <t t-set="company" t-value="o.company_id"></t>
            </t>
            <t t-if="not o or not 'company_id' in o">
                <t t-set="company" t-value="res_company"></t>
            </t>

            <t t-call="tour_travel_package_design.external_layout_header_custom2" />
            <t t-raw="0" />
            <t t-call="tour_travel_package_design.external_layout_footer_custom2" />
        </template>
        <template id="external_layout_header_custom2">
            <div class="header">
               <table width="100%" style="vertical-align:Middle">
                    <tr>
                        <td width="30%">
                            <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo"/>
                        </td>
                        <td width="70%"> 
                            <b>
                                <span style="font-size:25px;" t-field="o.company_id" />
                            </b>
                        </td>
                    </tr>
                </table>
            </div>
        </template>
        <template id="external_layout_footer_custom2">
            <div class="footer">
                <center>
                <div class="row">
                    <div class="col-xs-12" >
                        <t t-if="o.company_id">
                            <span t-field="o.company_id.name" style="font-size:14px;!important;font-family:verdana !important;color:#37502f;"/>
                            <t t-if="o.company_id.street">
                                <span t-field="o.company_id.street" style="font-size:14px;!important;font-family:verdana !important;color:#37502f;"/>
                            </t>
                            <t t-if="o.company_id.street2">
                                <span t-field="o.company_id.street2" style="font-size:14px;!important;font-family:verdana !important;color:#37502f;" />
                            </t>
                        </t>
                    </div>
                    <div class="row">
                        <t t-if="o.company_id.city">
                                <span t-field="o.company_id.city" style="font-size:14px;!important;font-family:verdana !important;color:#37502f;"/>
                            </t>
                            <t t-if="o.company_id.country_id">
                                - <span t-field="o.company_id.country_id.name" style="font-size:14px;!important;font-family:verdana !important;color:#37502f;"/>
                            </t>
                    </div>
                    <div class="row">
                        <span style="font-size:14px;!important;font-family:verdana !important;color:#37502f;">Tel :</span> 
                        <span t-field="o.company_id.phone" style="font-size:14px;!important;font-family:verdana !important;color:#37502f;"/>
                    </div>
                </div>
                </center>
            </div>
        </template>

        <template id="qweb_booking_ref_room_report">
            <t t-call="web.basic_layout">
                <t t-foreach="docs" t-as="o">
                    <t t-call="tour_travel_package_design.custom_external_layout_header2">
                        <div class="page">
                            <template id="report_css" inherit_id="web.layout">
                                <xpath expr="//head" position="inside">
                                    <link rel="stylesheet"
                                        href="/tour_travel_package_design/static/src/css/style.css" />
                                </xpath>
                            </template>
                            <div class=" col-md-12">
                                <center>
                                    <h2>
                                        Booking Ref
                                        <span t-field="o.name" />
                                    </h2>
                                </center>
                            </div>
                            <table width="100%">
                                <tr>
                                    <td width="65%">
                                        To :
                                        <span t-field="o.partner_id" />
                                    </td>
                                    <td width="35%">
                                        Date :
                                        <span t-field="o.date_order" />
                                    </td>
                                </tr>
                            </table>
                            <br/><br/>
                            <table width="50%">
                                <tr>
                                    <th style="color:red;">
                                        Booking Ref :
                                        <span t-field="o.name" />
                                    </th>
                                </tr>
                            </table>
                            <table width="50%" style="border:1px solid grey;">
                                <tr >
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">Nationality:</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <t t-if="o.sale_order_id and o.sale_order_id.passenger_ids">
                                           <span t-esc="get_country(o.sale_order_id.passenger_ids)" />
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">Hotel:</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <span t-field="o.order_line and o.order_line[0].product_id.name" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">Arrival Date:</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <span t-field="o.arrival_date" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">Departure Date:</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <span t-field="o.return_date" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">No. of rooms</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <t t-if="o.sale_order_id and o.order_line">
                                            <table class="text-center"><tr>
                                                <th style="padding:5px !important;">SGL</th>
                                                <th style="padding:5px !important;">DBL</th>
                                                <th style="padding:5px !important;">TPL</th>
                                             </tr>
                                             <tr>
                                                <td style="align:center;padding:5px !important;">
                                                    <t t-if="'single' in get_room(o.order_line)">
                                                        <span t-esc="get_room(o.order_line)['single']" />
                                                    </t>
                                                    <t t-if="'single' not in get_room(o.order_line)">
                                                        <span>0</span>
                                                    </t>
                                                </td>
                                                <td style="align:center;padding:5px !important;">
                                                    <t t-if="'double' in get_room(o.order_line)">
                                                        <span t-esc="get_room(o.order_line)['double']" />
                                                    </t>
                                                    <t t-if="'double' not in get_room(o.order_line)">
                                                        <span>0</span>
                                                    </t>
                                                </td>
                                                <td style="align:center;padding:5px !important;">
                                                    <t t-if="'tpl' in get_room(o.order_line)">
                                                        <span t-esc="get_room(o.order_line)['tpl']" />
                                                    </t>
                                                    <t t-if="'tpl' not in get_room(o.order_line)">
                                                        <span>0</span>
                                                    </t>
                                                </td>
                                            </tr></table>
                                        </t>
                                         
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">No. of Pax</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <t t-if="o.sale_order_id">
                                            <span t-field="o.sale_order_id.pax_group" />
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">Meal Plan</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <span t-field="o.meal_plan" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">Agreed Rate:</td>
                                    <td width="25%" style="border:1px solid grey;padding:5px !important;">
                                        <span t-field="o.agreed_rate" />
                                    </td>
                                </tr>
                            </table>
                            <br/><br/>
                            <div style="color:red;">Rooming List:</div>
                            <table class="table table-bordered table-condensed text-center" style="border-color:black !important;">
                                <tr>
                                    <th class="text-center">#</th>
                                    <th class="text-center">Name</th>
                                    <th class="text-center">Age</th>
                                    <th class="text-center">Room</th>
                                    <th class="text-center">Gender</th>
                                    <th class="text-center">Nationality</th>
                                    <th class="text-center">Remarks</th>
                                </tr>
                                <t t-if="o.sale_order_id and o.sale_order_id.passenger_ids">
                                    <t t-foreach="o.sale_order_id.passenger_ids" t-as="pas">
                                        <tr>
                                            <td><span t-field="pas.number" /></td>
                                            <td><span t-field="pas.partner_id and pas.partner_id.name" /></td>
                                            <td><span t-field="pas.age" /></td>
                                            <td><span t-field="pas.room" /></td>
                                            <td><span t-field="pas.gender" /></td>
                                            <td><span t-field="pas.country_id and pas.country_id.name" /></td>
                                            <td><span t-field="pas.type" /></td>
                                        </tr>
                                    </t>
                                    
                                </t>
                            </table>
                        <div class="col-sm-12" style="page-break-before: always;">
                            <h4><b>Terms &amp; Condition</b></h4>
                            <span t-field="o.sale_order_id and o.sale_order_id.note" />
                        </div>
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>

